# Data gather built from repo root so queue_interface + config_contract are in the image.
# Build: docker build -t fraud-pipeline/data-gather:latest -f pods/data-gather/Dockerfile.repo .
FROM python:3.11-slim

WORKDIR /app

RUN pip install --no-cache-dir \
    numpy>=1.26.0 \
    pyarrow>=14.0.0 \
    faker>=22.0.0 \
    psutil

COPY queue_interface.py config_contract.py ./
COPY pods/data-gather/gather.py ./

ENV PYTHONPATH=/app
ENV OUTPUT_DIR=/data/output
ENV NUM_WORKERS=128
ENV DURATION_SECONDS=60
ENV CHUNK_SIZE=1000000
ENV FRAUD_RATE=0.005
ENV PYTHONUNBUFFERED=1

CMD ["python", "gather.py"]
